<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Captural</title>

    <link
      href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&display=swap"
      rel="stylesheet" />
    <link rel="stylesheet" href="style.css" />
    <link rel="stylesheet" href="dashboard.css" />
    <link rel="stylesheet" href="login.css" />
  </head>
  <body>
    <!-- Login -->
    <div id="login-view" class="view-container login-view-container">
      <div class="page-wrapper">
        <div class="container" style="max-width: 500px">
          <div class="icon-container">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
              stroke-width="1.5">
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M10.05 4.575a1.575 1.575 0 10-3.15 0v3m3.15-3v-1.5a1.575 1.575 0 013.15 0v1.5m-3.15 0l.075 5.925m3.075.75V4.575m0 0a1.575 1.575 0 013.15 0V15M6.9 7.575a1.575 1.575 0 10-3.15 0v8.175a6.75 6.75 0 006.75 6.75h2.018a5.25 5.25 0 003.712-1.538l1.732-1.732a5.25 5.25 0 001.538-3.712l.003-2.024a.668.668 0 01.198-.471 1.575 1.575 0 10-2.228-2.228 3.818 3.818 0 00-1.12 2.687M6.9 7.575V12m6.27-2V4.575" />
            </svg>
          </div>

          <h1 class="title">Captural</h1>
          <p class="subtitle-small">Natural CAPTCHA</p>

          <div class="instructions">
            <div class="instruction-title">What you will do</div>
            <div class="instruction-item">
              <span class="instruction-number">1</span>
              <span>Solve a puzzle</span>
            </div>
            <div class="instruction-item">
              <span class="instruction-number">2</span>
              <span>Align an object with the indicated position</span>
            </div>
            <div class="instruction-item">
              <span class="instruction-number">3</span>
              <span>Get a summary of your performance</span>
            </div>
          </div>

          <div class="login-form">
            <div class="input-group">
              <label for="username">Username</label>
              <input
                type="text"
                id="username"
                placeholder="Enter username"
                autocomplete="off" />
              <span class="input-hint" id="usernameHint"></span>
            </div>
            <div class="input-group">
              <label for="password">Password</label>
              <input
                type="password"
                id="password"
                placeholder="Enter password" />
              <span class="input-hint" id="passwordHint"
                >Minimum 6 characters</span
              >
            </div>
          </div>

          <button id="start-captcha-btn" class="start-button" disabled>
            Start
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
              stroke-width="2">
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M14 5l7 7m0 0l-7 7m7-7H3" />
            </svg>
          </button>
        </div>
      </div>
    </div>

    <!-- Catcha modal -->
    <div id="captcha-modal" class="modal-overlay hidden">
      <div id="reference-container" class="reference-wrapper hidden">
        <p class="ref-label">Target Image</p>
        <img id="puzzle-target-image" src="" alt="Target" />
      </div>

      <div class="modal-content">
        <div class="modal-header">
          <h2 id="captcha-step-title">Security Check</h2>
        </div>

        <div class="canvas-wrapper">
          <video id="webcam" autoplay playsinline style="display: none"></video>
          <canvas id="output_canvas"></canvas>

          <div id="alignment-overlay" class="align-target-overlay" style="width: 180px; display: none; position: absolute; top: 20px; left: 20px; background: rgba(0,0,0,0.6); padding: 12px; border-radius: 12px; color: white; text-align: center;">
              
              <div id="alignment-status" style="margin-bottom: 8px; font-weight: bold; font-size: 14px; color: #ff4d4d;">
                  Kein Objekt gefunden
              </div>

              <div style="display: flex; flex-direction: column; align-items: center;">
                  <img id="alignment-target-img" src="" alt="Target" style="width: 100px;">
                  <span class="align-target-label" style="color: white; margin-top:4px; font-size: 12px; opacity: 0.6;">Target Position</span>
              </div>
          </div>

          <div id="loading-spinner" class="spinner"></div>
        </div>

        <p id="captcha-instruction" class="instruction-text">Initializing...</p>
      </div>
    </div>

    <!-- Dashboard -->
    <div id="dashboard-view" class="view-container hidden">
      <div class="orb-container">
        <div class="orb-1"></div>
        <div class="orb-2"></div>
      </div>
      <div class="container">
        <div class="header">
          <div class="status-badge passed" id="statusBadge">
            <div class="status-dot"></div>
            <span class="status-text" id="statusText">VERIFIED</span>
          </div>
          <h1 class="title">Captcha Result</h1>
          <p class="subtitle">Your Performance</p>

          <div id="naturalnessValue" class="naturalness-value"></div>
        </div>

        <div class="circles-container">
          <div class="circle-item">
            <div class="circle-wrapper">
              <svg
                width="140"
                height="140"
                viewBox="0 0 140 140"
                class="circle-svg">
                <circle cx="70" cy="70" r="54" class="circle-bg" />
                <circle
                  cx="70"
                  cy="70"
                  r="54"
                  class="circle-progress purple"
                  id="puzzleCircle"
                  stroke-dasharray="339.292"
                  stroke-dashoffset="339.292" />
              </svg>
              <div class="circle-text-overlay">
                <span class="circle-value" id="puzzleValue">0.0</span>
                <span class="circle-unit">sec</span>
              </div>
            </div>
            <span class="circle-label">Puzzle</span>
          </div>
          <div class="circle-item">
            <div class="circle-wrapper">
              <svg
                width="140"
                height="140"
                viewBox="0 0 140 140"
                class="circle-svg">
                <circle cx="70" cy="70" r="54" class="circle-bg" />
                <circle
                  cx="70"
                  cy="70"
                  r="54"
                  class="circle-progress violet"
                  id="objectCircle"
                  stroke-dasharray="339.292"
                  stroke-dashoffset="339.292" />
              </svg>
              <div class="circle-text-overlay">
                <span class="circle-value" id="objectValue">0.0</span>
                <span class="circle-unit">sec</span>
              </div>
            </div>
            <span class="circle-label">Object Alignment</span>
          </div>
          <div class="circle-item">
            <div class="circle-wrapper">
              <svg
                width="140"
                height="140"
                viewBox="0 0 140 140"
                class="circle-svg">
                <circle cx="70" cy="70" r="54" class="circle-bg" />
                <circle
                  cx="70"
                  cy="70"
                  r="54"
                  class="circle-progress green"
                  id="totalCircle"
                  stroke-dasharray="339.292"
                  stroke-dashoffset="339.292" />
              </svg>
              <div class="circle-text-overlay">
                <span class="circle-value" id="totalValue">0.0</span>
                <span class="circle-unit">sec</span>
              </div>
            </div>
            <span class="circle-label">Total</span>
          </div>
        </div>

        <div class="metrics-grid">
          <div class="metric-card">
            <div class="metric-label">Accuracy</div>
            <div class="metric-value" id="accuracyValue">0%</div>
            <div class="metric-sub">Average of both phases</div>
          </div>
          <div class="metric-card">
            <div class="metric-label">Errors</div>
            <div class="metric-value" id="errorsValue">0</div>
            <div class="metric-sub" id="errorsSub">0 puzzles · 0 alignment</div>
          </div>
        </div>

        <div class="phase-section">
          <h3 class="phase-title">Phase Details</h3>
          <div class="phase-bars">
            <div class="phase-bar">
              <div class="phase-bar-header">
                <span class="phase-name">Image Puzzle</span>
                <div class="phase-stats">
                  <span class="phase-errors" id="puzzleErrors">0 errors</span>
                  <span class="phase-time" id="puzzleTime">0.0s</span>
                </div>
              </div>
              <div class="phase-bar-track">
                <div class="phase-bar-fill" id="puzzleBar"></div>
              </div>
            </div>

            <div class="phase-bar">
              <div class="phase-bar-header">
                <span class="phase-name">Object Alignment</span>
                <div class="phase-stats">
                  <span class="phase-errors" id="objectErrors">0 errors</span>
                  <span class="phase-time" id="objectTime">0.0s</span>
                </div>
              </div>
              <div class="phase-bar-track">
                <div class="phase-bar-fill" id="objectBar"></div>
              </div>
            </div>
          </div>
        </div>

        <!-- Leaderboard -->
        <div id="leaderboard" class="phase-section leaderboard">
          <h3 class="phase-title">Leaderboard</h3>
          <div class="leaderboard-wrapper">
            <table id="leaderboardTable">
              <thead>
                <tr>
                  <th>#</th>
                  <th>Puzzle</th>
                  <th>Time</th>
                  <th>Errors</th>
                  <th>Natural</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
        <div class="footer">
          <p>Natural Captcha · NUI project 2026</p>
          <button
            id="reset-btn"
            style="
              background: none;
              border: none;
              color: #555;
              cursor: pointer;
              margin-top: 10px;
            ">
            Restart Captcha
          </button>
        </div>
      </div>
    </div>

    <script type="module" src="AppManager.js"></script>
  </body>
</html>
